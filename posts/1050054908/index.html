<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/ws-apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/ws-favicon-32x32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/ws-favicon-16x16.ico"><link rel="mask-icon" href="/images/ws-logo.svg" color="#222"><link rel="manifest" href="/images/ws-logo.webp"><meta name="google-site-verification" content="eG57s-n4iaYvUF7LighluCGPvzO3z_ESE7w3nWEROYI"><meta name="msvalidate.01" content="E00B9090E8046D5EB6DD9B07EBEDFA2A"><meta name="baidu-site-verification" content="code-cAwJVzSa3d"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"undeio.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"width":300},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script><meta name="description" content="记录黑苹果安装的过程，证明自己来过；  Apple 可能永远也不会再使用 Intel 的 CPU 了，所以 10 代 U 应该是最后一代完美黑苹果了， 11 代及以上 U 的核显驱动及大小核调度问题也可能永远无法完美解决了； 这几天又看到一个消息，说 Windows11 和 Intel 11+ 的 U 不再支持 SGX 功能了，也就是 Windows 平台播放超高清蓝光电影光盘的功能，部分 Wi"><meta property="og:type" content="article"><meta property="og:title" content="黑苹果安装笔记"><meta property="og:url" content="https://undeio.com/posts/1050054908/"><meta property="og:site_name" content="方塘·半亩"><meta property="og:description" content="记录黑苹果安装的过程，证明自己来过；  Apple 可能永远也不会再使用 Intel 的 CPU 了，所以 10 代 U 应该是最后一代完美黑苹果了， 11 代及以上 U 的核显驱动及大小核调度问题也可能永远无法完美解决了； 这几天又看到一个消息，说 Windows11 和 Intel 11+ 的 U 不再支持 SGX 功能了，也就是 Windows 平台播放超高清蓝光电影光盘的功能，部分 Wi"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy9ifm012lj30qo0e5gma.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gy9ilwqhhcj30qo0m9tc3.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyddxabfeej30qo0n877v.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gydegcjywwj30qo0n8dl0.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gydep9x4knj30qo067jrq.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydfr0q4rcj30qo0zs7bp.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydh25zvgnj30mw090754.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydh2fdrmaj30fs040751.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydhd4fyfhj30qo0c4t9u.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydhg1m8a0j30fi034q3f.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gydhkl8znwj30qo069t98.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyfsu3nhjjj30qq0b3768.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyft4izqqhj30ur0ocwi4.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyft562ns4j30q50q4n0q.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyft5k9r62j31800osgx8.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gye3jmwk2hj31es0pj7fo.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gye42ns2u4j30f70caab6.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyft64gyjwj30q50q4jux.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy4zjk5dcoj30y20iigpn.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy4zqiqbt3j30y20n879b.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy504c71ewj31co0tatd4.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy505nvwlij309208m0st.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy50h9z8xpj31or0u0n4u.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy50xul7o6j30y20swq6j.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy51250t32j31co0rowk9.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy515f7n29j31co0roafs.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy51mxz4n3j30sg0dogmf.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy51v94kjqj311l0u076d.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gy52dkh2z5j30ja0h8gmg.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyftcsn8g2j30ok0vomzg.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyemhv7ycnj312u0bsjsy.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyen4qaegdj31ds0rw10e.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeomocgqjj30rm0nw78m.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyentzmdmnj31e203gq3h.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeny6haijj30vc042wf2.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeo70gai9j30r4020aa9.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyfu751nxoj31m0094404.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeoo2hxtzj30u40r478n.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeotg18jhj30v40bwtan.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyep1lrqzlj30rw0l2779.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyep99ywtqj31340h4n14.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyepex9wm1j311k0neq72.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeph26at7j311k0ne0vj.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyftjfzmb4j310q0kin2e.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeps79d06j30qg0am0uc.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyfthvp3myj317n0u077f.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyftnwt4jij31bi0iwjv8.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyeqf8mnoxj314h0u0teh.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9k9n0ujj30wa0emabo.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9m64nfwj30vy0natax.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9pdbym5j30ww096wf3.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9t6ci5xj30wm054jrp.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9ujjh53j30wu0bmaas.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9vqneu7j30wm06iglv.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9wfl4evj30x207smxw.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9xcdaxtj30wc0hejsz.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9ygmrx2j30wm0bywff.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9z88iwfj30wc0cst9m.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9zxowk0j31420u0q8e.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gygcx83y6uj30u10eamz8.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gygd59vgwnj30u10eagnz.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gygdbunwruj30ik0ezgm8.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gygdr3s321j30ql02174o.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyge1dy7t5j30ea019748.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygeigcu5hj30go0h8wfw.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygeixifsxj30go0h8jsh.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygepztrszj30ik0ezq3u.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygw8a85jrj30wi0ssdiz.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygvueyu1aj30oo0gfdh1.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygvv9ja8fj30wl0mogov.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygvw7dqcgj30ga09rt95.jpg"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gygvwf8y89j30ga08pmxg.jpg"><meta property="article:published_time" content="2022-01-08T00:08:08.000Z"><meta property="article:modified_time" content="2022-01-08T00:08:08.000Z"><meta property="article:author" content="Undeio"><meta property="article:tag" content="Hackintosh"><meta property="article:tag" content="OpenCore"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gy9ifm012lj30qo0e5gma.jpg"><link rel="canonical" href="https://undeio.com/posts/1050054908/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://undeio.com/posts/1050054908/","path":"posts/1050054908/","title":"黑苹果安装笔记"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>黑苹果安装笔记 | 方塘·半亩</title><script src="/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?1dca64bee6b4ddd8e5704b56999cb693"></script><script type="text/javascript">!function(t,e,n,a,c,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(c=e.createElement(a)).async=1,c.src="https://www.clarity.ms/tag/an3nx1dk67",(r=e.getElementsByTagName(a)[0]).parentNode.insertBefore(c,r)}(window,document,"clarity","script")</script><meta name="msvalidate.01" content="E00B9090E8046D5EB6DD9B07EBEDFA2A"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">方塘·半亩</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">业精于勤，荒于嬉。行成于思，毁于随。</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%BA%E5%9E%8B%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">机型配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USB-%E5%AE%9A%E5%88%B6"><span class="nav-number">3.</span> <span class="nav-text">USB 定制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#USB-%E5%AE%9A%E5%88%B6%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.</span> <span class="nav-text">USB 定制的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Windows-%E4%B8%8B%E5%AE%9A%E5%88%B6"><span class="nav-number">3.1.1.</span> <span class="nav-text">Windows 下定制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#macOS-%E4%B8%8B%E5%AE%9A%E5%88%B6"><span class="nav-number">3.1.2.</span> <span class="nav-text">macOS 下定制</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#USB-%E5%AE%9A%E5%88%B6%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="nav-number">3.2.</span> <span class="nav-text">USB 定制的流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-USB-%E5%AE%89%E8%A3%85%E7%9B%98"><span class="nav-number">4.</span> <span class="nav-text">制作 USB 安装盘</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD-macOS"><span class="nav-number">4.1.</span> <span class="nav-text">下载 macOS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-U-%E7%9B%98"><span class="nav-number">4.2.</span> <span class="nav-text">制作 U 盘</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EFI-%E9%85%8D%E7%BD%AE"><span class="nav-number">5.</span> <span class="nav-text">EFI 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD-EFI-%E5%88%86%E5%8C%BA"><span class="nav-number">5.1.</span> <span class="nav-text">挂载 EFI 分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%B6%E9%9B%86%E5%BF%85%E5%A4%87%E6%96%87%E4%BB%B6"><span class="nav-number">5.2.</span> <span class="nav-text">收集必备文件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#OpenCore"><span class="nav-number">5.2.1.</span> <span class="nav-text">OpenCore</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Drivers"><span class="nav-number">5.2.2.</span> <span class="nav-text">Drivers</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Kexts"><span class="nav-number">5.2.3.</span> <span class="nav-text">Kexts</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ACPI"><span class="nav-number">5.2.4.</span> <span class="nav-text">ACPI</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%94%B6%E9%9B%86%E5%AE%8C%E6%AF%95"><span class="nav-number">5.3.</span> <span class="nav-text">文件收集完毕</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#config-plist-%E9%85%8D%E7%BD%AE"><span class="nav-number">5.4.</span> <span class="nav-text">config.plist 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-ACPI"><span class="nav-number">5.4.1.</span> <span class="nav-text">配置 ACPI</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-Booter"><span class="nav-number">5.4.2.</span> <span class="nav-text">配置 Booter</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-DeviceProperties"><span class="nav-number">5.4.3.</span> <span class="nav-text">配置 DeviceProperties</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-Kernel"><span class="nav-number">5.4.4.</span> <span class="nav-text">配置 Kernel</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-Misc"><span class="nav-number">5.4.5.</span> <span class="nav-text">配置 Misc</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-NVRAM"><span class="nav-number">5.4.6.</span> <span class="nav-text">配置 NVRAM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-PlatformInfo"><span class="nav-number">5.4.7.</span> <span class="nav-text">配置 PlatformInfo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-UEFI"><span class="nav-number">5.4.8.</span> <span class="nav-text">配置 UEFI</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BIOS-%E8%AE%BE%E7%BD%AE"><span class="nav-number">5.5.</span> <span class="nav-text">BIOS 设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">5.6.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%90%8E%E7%9A%84%E5%B7%A5%E4%BD%9C"><span class="nav-number">5.7.</span> <span class="nav-text">安装后的工作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%97%A0-U-%E7%9B%98%E5%90%AF%E5%8A%A8"><span class="nav-number">5.7.1.</span> <span class="nav-text">无 U 盘启动</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E5%A4%8D%E9%9F%B3%E9%A2%91"><span class="nav-number">5.7.2.</span> <span class="nav-text">修复音频</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#USB-%E5%94%A4%E9%86%92"><span class="nav-number">5.7.3.</span> <span class="nav-text">USB 唤醒</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">5.7.4.</span> <span class="nav-text">其他</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Undeio" src="/images/ws-avatar.jpg"><p class="site-author-name" itemprop="name">Undeio</p><div class="site-description" itemprop="description">也许似乎大概是，然而未必不见得。</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">73</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">56</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/Undeio" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Undeio" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i></a></span></div><div class="cc-license site-overview-item animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener external nofollow noreferrer" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><meting-js server="tencent" type="playlist" id="7909488549" order="random" list-max-height="146px"></meting-js></div></div><div class="back-to-top animated" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div class="sidebar-dimmer"></div></header><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://undeio.com/posts/1050054908/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/ws-avatar.jpg"><meta itemprop="name" content="Undeio"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="方塘·半亩"><meta itemprop="description" content="也许似乎大概是，然而未必不见得。"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="黑苹果安装笔记 | 方塘·半亩"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">黑苹果安装笔记</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-08 08:08:08" itemprop="dateCreated datePublished" datetime="2022-01-08T08:08:08+08:00">2022-01-08</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/macOS/" itemprop="url" rel="index"><span itemprop="name">macOS</span></a></span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>记录黑苹果安装的过程，证明自己来过；</p></blockquote><p>Apple 可能永远也不会再使用 Intel 的 CPU 了，所以 10 代 U 应该是最后一代完美黑苹果了， 11 代及以上 U 的核显驱动及大小核调度问题也可能永远无法完美解决了；</p><p>这几天又看到一个消息，说 Windows11 和 Intel 11+ 的 U 不再支持 SGX 功能了，也就是 Windows 平台播放超高清蓝光电影光盘的功能，部分 Windows 用户估计要头疼了，但这对黑苹果却是件好事儿，不过 11+ 的 U 也然并卵；</p><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ol><li>满足黑苹果硬件限制的电脑；</li><li>1 个大于等于（&gt;&#x3D;）16G 的 U 盘，Catalina.10.15.7.19H15 的大小为 8.27G ，而 Monterey.12.1.21C52 的大小为 12.17G，至于 BigSur 就不考虑了，应该是专为 M1 芯片优化的，何必用 Intel 的芯片去自取其辱呢？🐶（手动狗头）；</li><li>时间、耐心、细心、善用搜索引擎以及不耻下问；</li><li>时间、耐心、细心、善用搜索引擎以及不耻下问；</li><li>时间、耐心、细心、善用搜索引擎以及不耻下问；</li></ol><span id="more"></span><h3 id="机型配置"><a href="#机型配置" class="headerlink" title="机型配置"></a>机型配置</h3><table><thead><tr><th align="center">硬件</th><th align="center">型号</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">机箱</td><td align="center">机械大师 C34</td><td align="center">真的很小</td></tr><tr><td align="center">主板</td><td align="center">MSI Z490 GAMING CARBON WIFI</td><td align="center">ATX</td></tr><tr><td align="center">BIOS</td><td align="center">1.A0</td><td align="center">2021-09-30</td></tr><tr><td align="center">CPU</td><td align="center">Intel i9-10850K</td><td align="center">个人感觉比 10900K 香</td></tr><tr><td align="center">内存</td><td align="center">英睿达铂胜 D4 3600 16Gx4</td><td align="center">准备转投 PVE 或 UNRAID</td></tr><tr><td align="center">磁盘</td><td align="center">铠侠 RD10 1T</td><td align="center"></td></tr><tr><td align="center">声卡</td><td align="center">Realtek ALC1220P</td><td align="center">VEN_10EC &amp; DEV_1168</td></tr><tr><td align="center">有线网卡</td><td align="center">Realtek RTL8125B</td><td align="center">VEN_10EC &amp; DEV_8125</td></tr><tr><td align="center">无线网卡</td><td align="center">Intel AX201</td><td align="center">BIOS 禁用</td></tr><tr><td align="center">无线网卡</td><td align="center">BCM94360Z3</td><td align="center"></td></tr><tr><td align="center">蓝牙</td><td align="center">同上 👆</td><td align="center"></td></tr><tr><td align="center">显卡</td><td align="center">昂达 RX560 典藏版，说白了就是国内特供版 560D</td><td align="center">亮机卡，但原生驱动</td></tr><tr><td align="center">显示器</td><td align="center">三星 C24F390</td><td align="center">HDMI</td></tr></tbody></table><h3 id="USB-定制"><a href="#USB-定制" class="headerlink" title="USB 定制"></a>USB 定制</h3><p>USB 定制原因请阅读 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Post-Install/usb/">Why should you USB map</a></p><h4 id="USB-定制的方法"><a href="#USB-定制的方法" class="headerlink" title="USB 定制的方法"></a>USB 定制的方法</h4><p>USB 定制工具：</p><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/USBToolBox/tool/">USBToolBox</a>：Windows &amp; macOS；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/headkaze/Hackintool">Hackintool</a>：macOS；</li></ul><h5 id="Windows-下定制"><a href="#Windows-下定制" class="headerlink" title="Windows 下定制"></a>Windows 下定制</h5><p>在 Windows 下只能使用 USBToolBox 定制，Hackintool 是 macOS 专有软件，无法使用；</p><p>USBToolBox 定制分为两种情况：</p><ol><li>使用 Apple 原生类，会根据机型（<code>SIMBIOS ID</code>）生成<code>专用👇</code>的 USBMap.kext；</li><li>使用 USBToolBox 自有类，会生成<code>通用👇</code>的 UTBMap.kext，需要配合 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/USBToolBox/kext">USBToolBox.kext</a> 一起使用；</li></ol><p>解释一下上面 👆 的<code>专用</code>和<code>通用</code>（个人理解）：</p><ol><li><p>专用：使用的是 Apple 原生类， 在内核更新和机器升级的过程中，有些原生类只能用于特定机型，所以，定制时：需要指定你使用的<code>SIMBIOS ID</code>也就是机型，使用时：当前机器的<code>SIMBIOS ID</code>必须和定制时使用的<code>SIMBIOS ID</code>一致，才可以使用；</p></li><li><p>通用：使用的是 USBToolBox 自有类，在使用时会转换为当前机型可用的原生类，只要和你使用的主板（USB 端口）相同，就可以使用你定制的 UTBMap.kext，<code>SIMBIOS ID</code>也就是机型可以不一致；</p></li><li><p>好绕，总结一下，其他人若想使用你定制的 USBMap.kext，情况如下：</p><ol><li>专用：主板相同，<code>SIMBIOS ID</code>相同；</li><li>通用：主板相同；</li></ol></li><li><p>两种方式到底有什么区别呢？</p><p>通用定制可能会更方便且省时省力，但从 USBToolBox 自有类转换到 Apple 原生类并共享 USB 设备后，应该会有性能损失吧；</p><p>举个例子 🌰：有两块相同的主板，第一块主板使用的<code>SIMBIOS ID</code>为<code>Macmini8,1</code>，第二块主板使用的<code>SIMBIOS ID</code>为<code>MacBookPro16,1</code>，如果是通用定制，则定制一次，两块主板都可以使用，而专用定制需要分别定制才可以使用；</p></li></ol><h5 id="macOS-下定制"><a href="#macOS-下定制" class="headerlink" title="macOS 下定制"></a>macOS 下定制</h5><p>在 macOS 下可以使用 USBToolBox 或 Hackintool 来定制 USB；</p><ul><li><p>使用 USBToolBox 定制<br>macOS 下定制的过程和 Windows 下一致，但无法识别端口的绑定关系，需要分别定制 USB3.0 和 USB2.0，所以需要 USB3.0 和 USB2.0 的 U 盘各一个；</p><blockquote><p>小技巧：键鼠的无线接收器一般是 2.0，使用它即可；</p></blockquote></li><li><p>使用 Hackintool 定制<br>这里就不具体展开了，网上大佬写的教程很多也很详细；<br>但定制过程很麻烦也很痛苦，且系统版本不能高于 11.3（否则，解除 USB 端口数量限制的 XhciPortLimit 选项无效），所以还是推荐使用 USBToolBox 在 Windows 下定制；<br>定制完成后，需要使用生成的 SSDT-EC-USBX.aml 和 USBPort.kext；</p><blockquote><p>是的，你没看错，定制后会生成专用的 SSDT-EC-USBX.aml 和 USBPort.kext；</p></blockquote></li></ul><h4 id="USB-定制的流程"><a href="#USB-定制的流程" class="headerlink" title="USB 定制的流程"></a>USB 定制的流程</h4><p>USB 定制的方法很多，以下是在 Windows 下使用 USBToolBox 定制的流程；</p><ul><li><p>下载<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/USBToolBox/tool/">USBToolBox</a>，解压至任意位置，然后运行其中的<code>Windows.exe</code>，由于 USBToolBox 是 Python 打包的单文件应用，如报毒请无视；<br>USBToolBox 推荐的系统为 WIN10+，其他说明请通读 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/USBToolBox/tool/">README</a>，当前环境为 WIN10 LTSC 2019，并且会使用 Apple 原生类；</p></li><li><p>运行程序后是一个 CMD 应用：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy9ifm012lj30qo0e5gma.jpg" alt="是一个 CMD 应用"></p></li><li><p>然后输入 C 并回车，修改设置（输入不区分大小写，C 或 c 皆可，下同）：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gy9ilwqhhcj30qo0m9tc3.jpg" alt="修改设置选项"></p><p>分别输入 T 回车，N 回车，启用友好类型提示和使用 Apple 原生类；</p></li><li><p>输入 B 返回主菜单，然后输入 D 并回车，开始识别 USB：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyddxabfeej30qo0n877v.jpg" alt="开始识别 USB"></p><p>USBToolBox 可以识别出所有的 USB 控制器以及每个控制器下的所有 USB 端口；</p></li><li><p>接着，用准备好的 U 盘把机箱上所有的 USB 端口都插一遍，包括前置面板和 TYPE-C，每次拔插不要太快，可以等 U 盘识别后，手动安全弹出 U 盘；</p><p>TYPE-C 设备最好正反都插一次，看端口是否有变化，如果有变化，则后面会涉及到需要修改端口的类型；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gydegcjywwj30qo0n8dl0.jpg" alt="所有的 USB 端口都插一遍"></p><p>全部拔插一遍后，会发现实际上使用的 USB 接口没几个：绿色表示当前正在使用的接口，蓝色表示曾经有设备接入，而白色则表示从来没使用过的接口；</p></li><li><p>输入 B 并回车，返回主菜单：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gydep9x4knj30qo067jrq.jpg" alt="Saved Dat"></p><p>此时的<code>Saved Data</code> 会由<code>红色的 None</code>变为<code>绿色的 Loaded</code>，表示 USBToolBox 已经存储了当前的 USB 接口数据；</p><p><code>坐和放宽</code>，数据存储在本地的<code>usb.json</code>文件中，有时候软件可能会闪退（之前遇到两次），不过已经无伤大雅了，再打开就是了，如果没有到达这一步就闪退了，那么重头开始，再来一遍；</p></li><li><p>在主菜单按下 S 进入接口选择和生成 kext 界面：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydfr0q4rcj30qo0zs7bp.jpg" alt="接口选择和生成"></p><p>此处可以看到控制器 1 下有 17 个 USB 端口，超出了 macOS 单个控制器下接口不得超过 15 个的限制；</p><p>所以，这里需要取舍剔除 2 个端口以符合要求：通常，USB3.0 由于需要兼容 2.0，所以会绑定 2.0 端口，这样，一个 USB3.0 实际会占用 2 个端口的名额（图中 Companion to x 就表示 3.0 和 2.0 端口之间互相绑定，由 USBToolBox 自动识别，macOS 下定制无法识别绑定关系），所以，可以剔除某些 3.0 端口的 2.0 支持来达到要求，还有就是 TYPE-C 接口的设备通常都是 USB3.0，也可以剔除 TYPE-C 对 2.0 的支持；</p><p>举例说明每行端口各个选项的含义：</p><table><thead><tr><th align="center">[#]表示端口被使用</th><th align="center">序号</th><th align="center">端口号</th><th align="center">端口类型</th><th align="center">端口名称</th><th align="center">绑定关系</th></tr></thead><tbody><tr><td align="center">[#]</td><td align="center">1</td><td align="center">Port 1</td><td align="center">USB2.0</td><td align="center">USB 3 Type A (guessed)</td><td align="center">Companion to 17</td></tr></tbody></table><p>以端口 1 为例，表示端口 1 被使用，类型是 USB2.0，与 17 号端口互相绑定；</p></li><li><p>接下来就是端口的取舍了，以<code>port 3</code>和<code>port 4</code>为例：</p><p>操作之前先看说明：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydh25zvgnj30mw090754.jpg" alt="操作之前先看说明"></p><p>输入<code>3,4</code>并回车，端口 3 和 4 前面的选择(#)就会被取消：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydh2fdrmaj30fs040751.jpg" alt="端口 3 和 4 "></p><p>这里不能减少端口的数量，因为选择 3，4 的同时 19 和 20 端口也会被取消，所以多出来的端口需要修改生成的 USBMap.kext；</p></li><li><p>然后就是修改端口类型了，通常，mac 的蓝牙都是内建的，所以这里将会修改蓝牙占用的 USB 的类型：</p><p>首先输入 T 并回车显示类型说明：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydhd4fyfhj30qo0c4t9u.jpg" alt="显示类型说明"></p><p>然后输入<code>T:11:255</code>将蓝牙占用的 USB 改为内建：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydhg1m8a0j30fi034q3f.jpg" alt="蓝牙占用的 USB 改为内建"></p><p>其他修改请参考类型说明，然后根据自己的需要进行修改，可以同时修改多个端口为同一个类型，如：<code>T:1,2,3,4:0</code>；</p></li><li><p>至此，USB 定制已经接近尾声了，没有需要修改或调整的内容，输入 K 并回车，编译 USBMap.kext:</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gydhkl8znwj30qo069t98.jpg" alt="提示"></p><p>生成 kext 时，可能会提示某个控制器下有没有启用的端口，是需要忽略还是禁用，请根据自己的需要选择；</p><p>这里是 NVIDIA 显卡的控制器，没有什么用，直接 D 禁用；</p><p>然后会提示因为使用了 Apple 原生类，所以需要输入定制的机型（SMBIOS ID），本次将使用<code>iMac20,1</code>，所以输入并回车：</p><blockquote><p>注意 ⚠️：iMac20,2 is a custom SMBIOS meant only for Apple’s custom i9-10910 CPU, so unless you have an i9-10900K we recommend using iMac20,1<br>更多 SMBIOS 注意事项，请阅读 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Install-Guide/extras/smbios-support.html#how-to-decide">Choosing the right SMBIOS</a></p></blockquote><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyfsu3nhjjj30qq0b3768.jpg" alt="iMac20,1"></p><p>然后就会生成并保存 USBMap.kext，USB 定制就结束了；</p><p>这里还可以输入 B 并回车返回接口选择界面，然后生成不同机型的 USBMap.kext；</p><blockquote><p>如果使用的不是 Apple 原生类，而是 USBToolBox 类，会生成 UTBMap.kext，需要配合 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/USBToolBox/kext">USBToolBox.kext</a> 一起使用；</p></blockquote></li><li><p>修改<code>[USB|UTB]Map.kext</code> 剔除无用端口</p><p>接着上一步，按下 B 返回接口选择界面，然后用编辑器（这里使用 Notepad3）打开生成的 USBMap.kext，CTRL+F 搜索<code>AppleUSBHostController</code>（也就是 USB 控制器）：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyft4izqqhj30ur0ocwi4.jpg" alt="AppleUSBHostController"></p><p>可以看到一共有两个匹配字符串，因为定制的时候使用了两个控制器，（机器一共有三个控制器，最后定制时把 NVIDIA 显卡自带的控制器禁用了）下面的<code>ports</code>字典中的<code>HSxx</code>和<code>SSxx</code>就是每个 USB 端口；</p><p>至于怎么区分控制器，很简单，根据字典下面的端口数量，这里很明显，由于第一个控制器下只有两个端口，所以需要修改的控制器是第二个：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyft562ns4j30q50q4n0q.jpg" alt="需要修改的控制器是第二个"></p><p>第二个控制器下，HS 表示 USB2.0 端口，共 11 个，SS 表示 3.0 端口，共 6 个，合计 17 个端口，和定制时信息一致；</p><p>这里的端口顺序和端口选择界面的顺序是一致的，只不过编号中只包含了被使用（被 # 号选中）的端口，要删除哪个端口，数数就知道了：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyft5k9r62j31800osgx8.jpg" alt="端口顺序和端口选择界面的顺序是一致的"></p><p>如果还是不放心，展开字典的每个端口，对比端口类型：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gye3jmwk2hj31es0pj7fo.jpg" alt="对比端口类型"></p><p>这里以最后一个 USB2.0 端口（Prot 13）为例：</p><p>上面有两个 2.0 端口，分别是 <code>Port 10 USB3 Type A</code>和<code>Port 11 Internal</code>，对应的 USB Types 分别是<code>3</code>和<code>255</code>；<br>下面有两个 3.0 端口，分别是<code>Port 17 USB3 Type A</code>和<code>Port 18 USB3 Type A</code>，对应的 USB Types 都是<code>3</code>；</p><p>这里需要剔除的端口是 3 和 4，对应 USBMap.kext 文件中的 HS03 和 HS04，删除文件中对应的数据，包括 key 和 dict：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gye42ns2u4j30f70caab6.jpg" alt="删除文件中对应的数据"></p><p>key 和 dict 是一组键值对，需要匹配删除，而且 key 和 dict 都是双闭合标签，需要成对删除；</p><p>修改后的端口数据如下：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyft64gyjwj30q50q4jux.jpg" alt="修改后的端口数据如下"></p><p>HS（2.0）和 SS（3.0）端口共计 15 个，达到了 macOS 的要求，修改完成；</p></li><li><p>最后就是验证 USB 定制的成果了，需要在安装好 macOS 后用 Hackintool 验证，定制先告一段落；</p></li></ul><h3 id="制作-USB-安装盘"><a href="#制作-USB-安装盘" class="headerlink" title="制作 USB 安装盘"></a>制作 USB 安装盘</h3><p>可以使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.daliansky.net/">黑果小兵</a>前辈的懒人镜像，使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.balena.io/etcher/">balenaEtcher</a>写入 U 盘即可；</p><p>这里使用的官方原版镜像，方法来自 OC 官方教程<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Install-Guide/installer-guide/">Creating the USB</a>；</p><p>因为 macOS 用着顺手且有白苹果（MacBook Pro 2015），所以以下内容皆基于 macOS，使用 Windows 的小伙伴请参考官方文档；</p><h4 id="下载-macOS"><a href="#下载-macOS" class="headerlink" title="下载 macOS"></a>下载 macOS</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/macOS-installer &amp;&amp; cd ~/macOS-installer &amp;&amp; curl https://raw.githubusercontent.com/munki/macadmin-scripts/main/installinstallmacos.py &gt; installinstallmacos.py &amp;&amp; sudo python installinstallmacos.py</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这是官方文档给出的示例命令，用于获取 macOS 镜像，可以直接复制执行，也可以根据自己的需要修改；</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/Downloads/Hackintosh/macOS-installer # 创建文件夹</span><br><span class="line">cd ~/Downloads/Hackintosh/macOS-installer # 进入创建的文件夹</span><br><span class="line">curl https://raw.githubusercontent.com/munki/macadmin-scripts/main/installinstallmacos.py &gt; installinstallmacos.py # 获取远程的 python 脚本并写入 installinstallmacos.py 文件中，需要科学上网</span><br><span class="line">sudo python installinstallmacos.py # 执行获取的脚本</span><br></pre></td></tr></table></figure><p>执行脚本后会远程拉取镜像列表，选择自己需要的镜像并回车后，就会开始下载：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy4zjk5dcoj30y20iigpn.jpg" alt="下载镜像"></p><p>这里选择的是 8，也就是 Monterey.12.1.21C52，之前安装过 Catalina，所以就不需要下载了；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy4zqiqbt3j30y20n879b.jpg" alt="下载完成"></p><p>镜像很大，下载需要很长时间，下载完成后会提示镜像的位置；</p><blockquote><p>提示：只有在获取脚本时才需要科学上网，下载镜像时不需要科学上网，所以命令分开执行比较好，土豪随意；</p></blockquote><h4 id="制作-U-盘"><a href="#制作-U-盘" class="headerlink" title="制作 U 盘"></a>制作 U 盘</h4><ul><li><p>双击下载的镜像文件，如<code>Install_macOS_12.1-21C52.dmg</code>，然后将<code>安装 macos Monterey.app</code>拖入应用程序文件夹即可；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy504c71ewj31co0tatd4.jpg" alt="拖入应用程序文件夹"></p><p>如果启动台中出现<code>安装 macos Monterey</code>应用程序的图标，表示安装成功；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy505nvwlij309208m0st.jpg" alt="启动台"></p><p>淡定，不要运行<code>安装 macos Monterey</code>，这一步只是为了确认是否安装成功；</p></li><li><p>接着使用磁盘工具抹掉 U 盘，格式选择<code>Mac OS 扩展式</code>，名称随意；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy50h9z8xpj31or0u0n4u.jpg" alt="抹掉 U 盘"></p></li><li><p>然后打开终端执行命令将<code>安装 macos Monterey</code>程序写入 U 盘；</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Monterey</span></span><br><span class="line">sudo /Applications/Install\ macOS\ Monterey.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Catalina</span></span><br><span class="line">sudo /Applications/Install\ macOS\ Catalina.app/Contents/Resources/createinstallmedia --volume /Volumes/MyVolume</span><br></pre></td></tr></table></figure><p>命令末尾的<code>MyVolume</code>请替换为抹除磁盘时的命名，然后回车，等待写入完成；</p><p>到这一步就制作好 USB 安装盘了，如果是白苹果，就可以拿着 U 盘去恢复系统了，但黑苹果还缺少最重要的 EFI 文件；</p></li></ul><h3 id="EFI-配置"><a href="#EFI-配置" class="headerlink" title="EFI 配置"></a>EFI 配置</h3><h4 id="挂载-EFI-分区"><a href="#挂载-EFI-分区" class="headerlink" title="挂载 EFI 分区"></a>挂载 EFI 分区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo diskutil list</span><br></pre></td></tr></table></figure><p>首先查看当前系统中的磁盘：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy50xul7o6j30y20swq6j.jpg" alt="查看当前系统中的磁盘"></p><p>可以看到<code>disk6s1</code>就是 U 盘的 EFI 分区，且此时，文件管理器中只显示当前挂载的磁盘：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy51250t32j31co0rowk9.jpg" alt="只显示当前挂在的磁盘"></p><p>然后执行下面命令，挂载 EFI 分区：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo diskutil mount disk6s1</span><br></pre></td></tr></table></figure><p>命令执行后，再回到访达中，此时侧边栏就会显示已经挂载的 EFI 分区，它就是接下来要操作的文件夹：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy515f7n29j31co0roafs.jpg" alt="显示已经挂载的 EFI 分区"></p><p>此时的 EFI 分区啥也没有，一片空白；</p><h4 id="收集必备文件"><a href="#收集必备文件" class="headerlink" title="收集必备文件"></a>收集必备文件</h4><p>安装过程中可能会出现各种各样的问题，所以推荐所有文件使用 DEBUG 版本，没有问题后再使用 RELEASE 版本替换即可；</p><h5 id="OpenCore"><a href="#OpenCore" class="headerlink" title="OpenCore"></a>OpenCore</h5><p>在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/OpenCorePkg/releases/">OpenCorePkg</a>中下载最新版本的 OC，然后解压：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy51mxz4n3j30sg0dogmf.jpg" alt="OpenCore"></p><p>文件夹说明：</p><ol><li><strong>Docs</strong>：存放 OC 最新的配置文件、版本说明、ACPI 示例文件以及 Sample.list 配置文件模板；</li><li><strong>IA32</strong>：存放 32 位机器使用的 EFI 引导文件；</li><li><strong>Utilities</strong>：OC 官方集成的小工具都放在这里；</li><li><strong>X64</strong>： 存放 64 位机器使用的 EFI 引导文件；</li></ol><p>这里，将<code>X64</code>文件夹下的<code>EFI</code>文件夹拷贝到刚刚挂载的 EFI 分区中，此时的 EFI 分区应该是这样的：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gy51v94kjqj311l0u076d.jpg" alt="此时的 EFI 分区"></p><p>然后根据官方文档的说明，剔除无用内容后，目录结构如下：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gy52dkh2z5j30ja0h8gmg.jpg" alt="剔除无用内容"></p><p>有争议的是<code>OpenHfsPlus.efi</code>，网上大佬都说保留<code>OpenHfsPlus.efi</code>，不要使用<code>HfsPlus.efi</code>，而且<code>HfsPlus.efi</code>不维护了，但我查看官方仓库，发现上次更新日期是 2021.11.02，也就是上次 OC 发布的时候，这里暂时跟随官方文档说明，剔除<code>OpenHfsPlus.efi</code>；</p><h5 id="Drivers"><a href="#Drivers" class="headerlink" title="Drivers"></a>Drivers</h5><ol><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/OcBinaryData/blob/master/Drivers/HfsPlus.efi">HfsPlus.efi</a>，必需；</li><li>OpenRuntime.efi，必需，已包含在 OC 中；</li></ol><h5 id="Kexts"><a href="#Kexts" class="headerlink" title="Kexts"></a>Kexts</h5><ol><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/VirtualSMC/releases">VirtualSMC</a>，必需；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/Lilu/releases">Lilu</a>，必需；</li><li><code>SMCProcessor.kext</code>：CPU 温度，可选，包含在<code>VirtualSMC</code>包中；</li><li><code>SMCSuperIO.kext</code>：风扇转速，可选，包含在<code>VirtualSMC</code>包中；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/WhateverGreen/releases">WhateverGreen</a>，必需；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/AppleALC/releases">AppleALC</a>，音频；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.insanelymac.com/forum/files/file/1004-lucyrtl8125ethernet/">LucyRTL8125Ethernet</a>，有线网络；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/AirportBrcmFixup/releases">AirportBrcmFixup</a>，博通网卡；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/BrcmPatchRAM/releases">BrcmPatchRAM3</a>，博通网卡上的蓝牙；</li><li><code>BrcmFirmwareData.kext</code>：包含在<code>BrcmPatchRAM</code>包中，<code>BrcmPatchRAM3</code>的依赖组件；</li><li><code>BlueToolFixup.kext</code>：包含在<code>BrcmPatchRAM</code>包中，Monterey 及以上蓝牙需要，替换<code>BrcmBluetoothInjector.kext</code>；</li><li><del><code>BrcmBluetoothInjector.kext</code></del>：包含在<code>BrcmPatchRAM</code>包中，BigSur 需要，Monterey 不可用；</li><li><code>USBMap.kext</code>：将修改好的 USB 定制文件放入 Kexts 文件夹；</li></ol><h5 id="ACPI"><a href="#ACPI" class="headerlink" title="ACPI"></a>ACPI</h5><p>根据 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Install-Guide/ktext.html#ssdts">SSDTs</a>的说明，获取对应的预构建文件即可；</p><p>如果想要更稳定的使用，或是有洁癖，可以根据<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/Getting-Started-With-ACPI/">Getting started with ACPI</a>文档的说明，提取并构建属于自己的 SSDTs；</p><p>这里是十代桌面 U，所以需要的文件如下：</p><ol><li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/plug-methods/prebuilt.html#wrapping-up">SSDT-PLUG</a>：电源管理；</p></li><li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/ec-methods/prebuilt.html#wrapping-up">SSDT-EC-USBX</a>：USB 修复；</p></li><li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/awac-methods/prebuilt.html#wrapping-up">SSDT-AWAC</a>：系统时钟；</p></li><li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/rhub.html">SSDT-RHUB</a>：400 系列主板 USB 修复；</p><p>由于文档中 MSI 主板的情况未知，所以暂时先不添加，安装后再根据实际情况决定是否需要；</p></li></ol><h4 id="文件收集完毕"><a href="#文件收集完毕" class="headerlink" title="文件收集完毕"></a>文件收集完毕</h4><p>至此，所有所需的文件就已经收集完毕了，这时候的文件目录看起来如下：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyftcsn8g2j30ok0vomzg.jpg" alt="文件收集结束"></p><h4 id="config-plist-配置"><a href="#config-plist-配置" class="headerlink" title="config.plist 配置"></a>config.plist 配置</h4><p>当前 config.plist 的配置遵循<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Install-Guide/config.plist/comet-lake.html#starting-point">Desktop Comet Lake</a>的配置说明；</p><p>配置所需工具：</p><ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/corpnewt/ProperTree">ProperTree</a>：plist 编辑器；</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/corpnewt/GenSMBIOS">GenSMBIOS</a>：用来生成三码；</li></ul><ol><li><p>从<code>OC/Docs</code>下复制<code>Sample.plist</code>文件到<code>EFI/OC</code>目录下，并改名为<code>config.plist</code>：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyemhv7ycnj312u0bsjsy.jpg" alt="Sample.plist"></p></li><li><p>运行 ProperTree，按下 Cmd + O 打开<code>EFI/OC/config.plist</code>文件，最后<code>Cmd + Shift + R</code>将目录指向<code>EFI/OC/</code>执行清洁载入：</p><p>这样做会删除 config.plist 中所有的内容，然后根据收集的文件重写；</p></li></ol><h5 id="配置-ACPI"><a href="#配置-ACPI" class="headerlink" title="配置 ACPI"></a>配置 ACPI</h5><p>首先是编辑 ACPI</p><p>这里没有什么需要编辑的，只需要确认<code>config.plist</code>文件中载入的文件与收集的文件一致即可，其他保持默认；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyen4qaegdj31ds0rw10e.jpg" alt="载入的文件与收集的文件一致"></p><h5 id="配置-Booter"><a href="#配置-Booter" class="headerlink" title="配置 Booter"></a>配置 Booter</h5><table><thead><tr><th align="center">Quirk</th><th align="center">Enabled</th></tr></thead><tbody><tr><td align="center">DevirtualiseMmio</td><td align="center">YES</td></tr><tr><td align="center">EnableWriteUnprotector</td><td align="center">NO</td></tr><tr><td align="center">ProtectUefiServices</td><td align="center">YES</td></tr><tr><td align="center">RebuildAppleMemoryMap</td><td align="center">YES</td></tr><tr><td align="center">SetupVirtualMap</td><td align="center">NO</td></tr><tr><td align="center">SyncRuntimePermissions</td><td align="center">YES</td></tr></tbody></table><p>设置如下：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeomocgqjj30rm0nw78m.jpg" alt="Booter"></p><h5 id="配置-DeviceProperties"><a href="#配置-DeviceProperties" class="headerlink" title="配置 DeviceProperties"></a>配置 DeviceProperties</h5><p>这里可以添加 PCI 设备，但这些都可以往后稍一稍，首先保证声卡和核显正常驱动，其他设备可以等安装完成后使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mackie100projects.altervista.org/download-opencore-configurator/">OpenCore Configurator</a> 自动识别添加，比自己添加省时省力；</p><ul><li><p>首先是声卡，根据设备声卡的型号，在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/AppleALC/wiki/Supported-codecs">AppleALC Supported Codecs</a>中找到合适的<code>layout-id</code>，然后写入 config.plist 中：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyentzmdmnj31e203gq3h.jpg" alt="AppleALC Supported Codecs"></p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeny6haijj30vc042wf2.jpg" alt="写入 config.plist 中"></p><p>需要注意的是写入时的数据格式，如果数据格式是<code>Number</code>则直接填入 layout-id 即可，如上图 👆；</p><p>但如果数据格式是<code>Data</code>，则需要将 layout-id 转换为 16 进制数字，然后以<code>小端序</code>方式写入；</p></li><li><p>接着是核显：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeo70gai9j30r4020aa9.jpg" alt="核显"><br>这里添加的很简单，只需要让 macOS 识别核显即可；</p><table><thead><tr><th align="center">Key</th><th align="center">Type</th><th align="center">Value</th></tr></thead><tbody><tr><td align="center">AAPL,ig-platform-id</td><td align="center">Data</td><td align="center">07009B3E</td></tr><tr><td align="center">framebuffer-patch-enable</td><td align="center">Data</td><td align="center">01000000</td></tr><tr><td align="center">framebuffer-stolenmem</td><td align="center">Data</td><td align="center">00003001</td></tr></tbody></table><p>文档中 UHD630 的配置是这样的，下面两个选项用于修复显卡内存被盗问题，这里使用的主板 BIOS 可以设置，所以不用设置这两个选项；</p></li></ul><h5 id="配置-Kernel"><a href="#配置-Kernel" class="headerlink" title="配置 Kernel"></a>配置 Kernel</h5><p>文档说明保留 ProperTree 载入的 kext 顺序，且 ProperTree 调整顺序比较麻烦，所以 kext 加载顺序暂不调整，安装完后使用 OCC 进行调整；</p><p>设置<code>AirPortBrcm4360_Injector.kext</code>的<code>MinKernel</code>为<code>19.9.9</code>，阻止在 Monterey 上加载，详细说明请阅读<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Install-Guide/extras/big-sur/#known-issues">Known issues</a>；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyfu751nxoj31m0094404.jpg" alt="AirPortBrcm4360_Injector.kext"></p><table><thead><tr><th align="center">Quirk</th><th align="center">Enabled</th><th align="center">Comment</th></tr></thead><tbody><tr><td align="center">AppleXcpmCfgLock</td><td align="center">YES</td><td align="center">如果 BIOS 可以关闭 CFG 锁则可以不用设置此选项</td></tr><tr><td align="center">DisableIoMapper</td><td align="center">YES</td><td align="center">如果 BIOS 可以禁用 VT-D 则可以不用设置此选项</td></tr><tr><td align="center">LapicKernelPanic</td><td align="center">NO</td><td align="center">惠普机器需要开启此选项</td></tr><tr><td align="center">PanicNoKextDump</td><td align="center">YES</td><td align="center"></td></tr><tr><td align="center">PowerTimeoutKernelPanic</td><td align="center">YES</td><td align="center"></td></tr><tr><td align="center">XhciPortLimit</td><td align="center">NO</td><td align="center">解除 USB 端口最大数量限制，macOS 系统版本大于 11.3 则需要关闭此选项</td></tr></tbody></table><p>设置如下：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeoo2hxtzj30u40r478n.jpg" alt="Kernel"></p><h5 id="配置-Misc"><a href="#配置-Misc" class="headerlink" title="配置 Misc"></a>配置 Misc</h5><ul><li><p>Debug 下的选项有助于在出问题时调试，设置如下：</p><table><thead><tr><th align="center">Quirk</th><th align="center">Enabled</th></tr></thead><tbody><tr><td align="center">AppleDebug</td><td align="center">YES</td></tr><tr><td align="center">ApplePanic</td><td align="center">YES</td></tr><tr><td align="center">DisableWatchDog</td><td align="center">YES</td></tr><tr><td align="center">Target</td><td align="center">67</td></tr></tbody></table><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeotg18jhj30v40bwtan.jpg" alt="Debug"></p></li><li><p>Security</p><table><thead><tr><th align="center">Quirk</th><th align="center">Enabled</th><th align="center">Comment</th></tr></thead><tbody><tr><td align="center">AllowNvramReset</td><td align="center">YES</td><td align="center"></td></tr><tr><td align="center">AllowSetDefault</td><td align="center">YES</td><td align="center"></td></tr><tr><td align="center">BlacklistAppleUpdate</td><td align="center">YES</td><td align="center"></td></tr><tr><td align="center">ScanPolicy</td><td align="center">0</td><td align="center"></td></tr><tr><td align="center">SecureBootModel</td><td align="center">Default</td><td align="center"></td></tr><tr><td align="center">Vault</td><td align="center">Optional</td><td align="center">必填项，数据类型 String，Optional 首字母大写</td></tr></tbody></table><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyep1lrqzlj30rw0l2779.jpg" alt="Security"></p></li></ul><h5 id="配置-NVRAM"><a href="#配置-NVRAM" class="headerlink" title="配置 NVRAM"></a>配置 NVRAM</h5><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyep99ywtqj31340h4n14.jpg" alt="NVRAM"></p><p>主要是开启啰嗦模式（跑代码模式），防止固件更新等；</p><p>据说将<code>prev-lang:kdb</code>设置为<code>en-US:0</code>不容易出错，应该是玄学问题，且先设置上吧，缺点就是安装界面是英文，默认的数据类型是<code>Data</code>，需要 16 进制小端序写入数据，如果要填<code>en-US:0</code>，请将数据类型更改为<code>String</code>；</p><h5 id="配置-PlatformInfo"><a href="#配置-PlatformInfo" class="headerlink" title="配置 PlatformInfo"></a>配置 PlatformInfo</h5><ul><li><p>运行 GenSMBIOS，首先输入 1 并回车，更新 MacSerial：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyepex9wm1j311k0neq72.jpg" alt="更新 MacSMacSerial"></p></li><li><p>然后输入 3 并回车，表示需要生成 SMBIOS 信息：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeph26at7j311k0ne0vj.jpg" alt="输入 3 并回车"></p></li><li><p>接着输入机型并回车，就会生成三码：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyftjfzmb4j310q0kin2e.jpg" alt="生成三码"></p><p>不要着急，打开<a target="_blank" rel="noopener external nofollow noreferrer" href="https://checkcoverage.apple.com/cn/zh/">Apple Check Coverage page</a>输入生成的<code>Serial</code>验证序列号可用性：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeps79d06j30qg0am0uc.jpg" alt="Apple Check Coverage page"></p><p>如果提示无法验证等类似信息，则表示序列号可用；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyfthvp3myj317n0u077f.jpg" alt="序列号有效"></p><p>如果提示序列号有效等信息，则绝对不可用，请重新生成；</p><p>然后将三码（五码）写入 config.plist:</p><p>对应关系如下：</p><table><thead><tr><th align="center">SMBIOS</th><th align="center">Generic</th></tr></thead><tbody><tr><td align="center">Type</td><td align="center">SystemProductName</td></tr><tr><td align="center">Serial</td><td align="center">SystemSerialNumber</td></tr><tr><td align="center">Board Serial</td><td align="center">MLB</td></tr><tr><td align="center">SmUUID</td><td align="center">SystemUUID</td></tr><tr><td align="center">Apple ROM</td><td align="center">ROM</td></tr></tbody></table><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gyftnwt4jij31bi0iwjv8.jpg" alt="五码"></p><p>生成的 Apple ROM 没有任何作用，如果要在机器上使用 iMessage 请阅读<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Post-Install/universal/iservices.html#using-gensmbios">iServices</a>；</p></li></ul><h5 id="配置-UEFI"><a href="#配置-UEFI" class="headerlink" title="配置 UEFI"></a>配置 UEFI</h5><p><code>APFS Versions</code>的<code>Min Version</code>和<code>Min Date</code>设置为 -1；</p><table><thead><tr><th align="center">Quirk</th><th align="center">Enabled</th><th align="center">Comment</th></tr></thead><tbody><tr><td align="center">UnblockFsConnect</td><td align="center">NO</td><td align="center">Needed mainly by HP motherboards</td></tr></tbody></table><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyeqf8mnoxj314h0u0teh.jpg" alt="UEFI"></p><h4 id="BIOS-设置"><a href="#BIOS-设置" class="headerlink" title="BIOS 设置"></a>BIOS 设置</h4><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9k9n0ujj30wa0emabo.jpg" alt="Above 4G decoding"></p><ul><li>[启用] Above 4G decoding；</li><li>[禁用] Re-Size BAR Support</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9m64nfwj30vy0natax.jpg" alt="CNVi"></p><ul><li>[禁用] Onboard CNVi Module Control，自带的 CNVi 协议的 AX201 网卡；</li><li>SATA 模式：AHCI；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9pdbym5j30ww096wf3.jpg" alt="多显卡"></p><ul><li>设置第一显卡为 PEG 的前提是有可用的独立显卡；</li><li>集显共享内存：64MB；</li><li>[启用] 集成显卡多显示器；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9t6ci5xj30wm054jrp.jpg" alt="雷电"></p><ul><li>[禁用] Thunderbolt Support；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9ujjh53j30wu0bmaas.jpg" alt="xhci"></p><ul><li>[启用] XHCI Hand-off；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9vqneu7j30wm06iglv.jpg" alt="串口"></p><ul><li>[禁用] 超级 IO&#x2F;串口；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9wfl4evj30x207smxw.jpg" alt="USB唤醒"></p><ul><li>[启用] USB 唤醒；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9xcdaxtj30wc0hejsz.jpg" alt="BIOS 启动模式"></p><ul><li>BIOS Model：UEFI；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9ygmrx2j30wm0bywff.jpg" alt="快速启动"></p><ul><li>[禁用] 所有的快速启动；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9z88iwfj30wc0cst9m.jpg" alt="安全启动"></p><ul><li>[禁用] 安全启动；</li></ul><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyf9zxowk0j31420u0q8e.jpg" alt="CFG"></p><ul><li>[禁用] VT-D；</li><li>[禁用] CFG 锁定；</li><li>[禁用] SGX；</li></ul><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul><li>还是 AMD 显卡香，不用配置直接点亮（需要原生支持的型号，有些型号需要仿冒）；</li><li>安装过程基本一帆风顺，刚开始时遇到禁止符号和花屏，是因为忘记将修改的 USBMap.kext 文件放入 Kexts 文件夹了，在 Windows 上改完后放在 U 盘忘记替换了；</li></ul><h4 id="安装后的工作"><a href="#安装后的工作" class="headerlink" title="安装后的工作"></a>安装后的工作</h4><p>按照<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dortania.github.io/OpenCore-Post-Install/#how-to-follow-this-guide">OpenCore Post-Install</a>的说明，逐步检查，看系统中是否有相同或类似的问题并修复，既然文档中提到了，那么这些问题肯定是常见的，就不要抱有侥幸心理了；</p><h5 id="无-U-盘启动"><a href="#无-U-盘启动" class="headerlink" title="无 U 盘启动"></a>无 U 盘启动</h5><p>也就是将 U 盘上的 EFI 文件复制到磁盘 EFI 分区；</p><p>打开终端，输入下面命令查看当前挂载的磁盘：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskutil list</span><br></pre></td></tr></table></figure><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gygcx83y6uj30u10eamz8.jpg" alt="查看当前挂载的磁盘"></p><p>可以看到，系统磁盘 EFI 分区为<code>disk0s1</code>，U 盘 EFI 分区为<code>disk2s1</code>，然后挂载这两个 EFI 分区：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo diskutil mount disk0s1</span><br><span class="line"></span><br><span class="line">sudo diskutil mount disk2s1</span><br></pre></td></tr></table></figure><p>挂载好后，访达侧边栏会显示当前挂载的磁盘：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gygd59vgwnj30u10eagnz.jpg" alt="挂载好后"></p><p>如何区分到底是谁的 EFI 分区呢？</p><ul><li>现在系统磁盘的 EFI 分区是空的，所以有内容的就是 U 盘的 EFI 分区；</li><li>仔细观察，系统磁盘和外置磁盘的图标是不一样的，所以图标相同的是同一磁盘；</li></ul><p>然后拷贝 U 盘的 EFI 文件夹到系统磁盘的 EFI 分区（注意：是整个文件夹）；</p><p>这样，就可以不用 U 盘启动了；</p><h5 id="修复音频"><a href="#修复音频" class="headerlink" title="修复音频"></a>修复音频</h5><p>打开系统偏好设置，发现声音中没有出现预期的声音输出，只有一个显示器音频输出：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gygdbunwruj30ik0ezgm8.jpg" alt="没有出现预期的声音输出"></p><p>首先检查<code>Lilu</code>&#x2F;<code>AppleALC</code>&#x2F;<code>AppleHDA</code>是否正常加载：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kextstat | grep -E &quot;AppleHDA|AppleALC|Lilu&quot;</span><br></pre></td></tr></table></figure><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gygdr3s321j30ql02174o.jpg" alt="首先检查"></p><p>结果显示 <code>AppleHDA</code> 没有正常加载，要么是 <code>PciRoot</code> 地址不对，要么是 <code>layout-id</code> 不对；</p><p>下载<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/acidanthera/gfxutil/releases">gfxutil</a>然后输入下面命令，检查 PciRoot：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path/to/gfxutil -f HDEF</span><br></pre></td></tr></table></figure><p><code>path/to/gfxutil</code>替换为下载好的 gfxutil 的实际地址；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gyge1dy7t5j30ea019748.jpg" alt="gfxutil"></p><p>然后打开系统磁盘 EFI 分区下的<code>config.plist</code>，这里使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/coteditor/CotEditor/releases">CotEditor</a>打开，按下 Cmd+F 搜索 PciRoot：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygeigcu5hj30go0h8wfw.jpg" alt="搜索 PciRoot"></p><p>很明显，由于指定的设备不对，所以即使有驱动也没什么用，So，改了它；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygeixifsxj30go0h8jsh.jpg" alt="改了它"></p><p>改好后（记得保存）重新启动，反正现在也不用 U 盘了；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygepztrszj30ik0ezq3u.jpg" alt="重启后"></p><p>重启后，声音设备出现，测试后正常，修复完毕；</p><h5 id="USB-唤醒"><a href="#USB-唤醒" class="headerlink" title="USB 唤醒"></a>USB 唤醒</h5><p>启用 BIOS 的<code>USB从 S3/S4/S5 唤醒</code>，同时会自动的禁用<code>USB Standby Power at S4/S5</code>；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygw8a85jrj30wi0ssdiz.jpg" alt="USB从 S3/S4/S5 唤醒"></p><h5 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h5><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygvueyu1aj30oo0gfdh1.jpg" alt="GPU"></p><p>GPU 硬件加速正常；</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygvv9ja8fj30wl0mogov.jpg" alt="USB"></p><p>USB 测试正常；</p><p>关于本机：</p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygvw7dqcgj30ga09rt95.jpg" alt="关于本机"></p><p><img data-src="https://tva1.sinaimg.cn/large/008i3skNgy1gygvwf8y89j30ga08pmxg.jpg" alt="内存"></p><p>其他内容未改动，包括但不限于：</p><ul><li>系统报告中的 PCI 设备，未添加；</li><li>系统报告中的内存信息，未定制；</li><li>Wi-Fi，蓝牙，随航正常；</li><li>开关机，睡眠，唤醒正常(测试时间较短，仅供参考)；</li><li>OC 主题未定制；</li><li>啰嗦模式未关闭，当前所有文件为 DEBUG 版本；</li></ul></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>Undeio</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://undeio.com/posts/1050054908/" title="黑苹果安装笔记">https://undeio.com/posts/1050054908/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"><a href="/tags/Hackintosh/" rel="tag"><i class="fa fa-tag"></i> Hackintosh</a> <a href="/tags/OpenCore/" rel="tag"><i class="fa fa-tag"></i> OpenCore</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/1481924893/" rel="prev" title="Homebrew 配合 shell 脚本自动安装软件"><i class="fa fa-chevron-left"></i> Homebrew 配合 shell 脚本自动安装软件</a></div><div class="post-nav-item"><a href="/posts/4290690234/" rel="next" title="用 CSS 实现元素水平垂直居中">用 CSS 实现元素水平垂直居中 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Undeio</span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Gemini</a> 强力驱动</div><div class="busuanzi" style="display:none"><span id="busuanzi_container_site_uv" style="display:none;float:left">全站访问量<span id="busuanzi_value_site_uv"></span>次</span> <span id="busuanzi_container_site_pv" style="display:none;float:left">全站点击量<span id="busuanzi_value_site_pv"></span>次</span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>!(function () {
    const parent = document.querySelector(".busuanzi");
    const child = document.querySelector("#busuanzi_value_site_uv");
    setTimeout(function timer(count = 5) {
        if (child.innerText) {
            parent.style.display = "block";
            return;
        }
        setTimeout(() => {
            if (count-- > 0) {
                timer(count);
            }
        }, count * 1000);
    }, 0);
})();</script><div class="access-ip" style="display:none"></div><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script>!(function () {
    const ip = document.querySelector(".access-ip");
    try {
        ip.innerText = `当前访问IP: ${returnCitySN["cip"]} ${returnCitySN["cname"]}`;
        ip.style.display = "block";
    } catch (error) {
        console.error('Script 加载失败：GET“https://pv.sohu.com/cityjson?ie=utf-8”。', error);

        fetch("https://ipapi.co/ip/")
        .then(function (response) {
            response.text().then((txt) => {
                ip.innerText = `当前访问IP: ${txt}`;
                ip.style.display = "block";
            });
        })
        .catch(function (error) {
            console.error('Fetch 加载失败：GET“https://ipapi.co/ip/”。', error);
        });
    }
})();</script></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js","integrity":"sha256-7wT34TI0pEBeEFoi4z+vhuSddGh6vUTMWdqJ2SDe2jg="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script><script src="/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"Undeio/undeio.github.io","issue_term":"title","theme":"github-light"}</script><script src="/js/third-party/comments/utterances.js"></script></body></html>